<!DOCTYPE html>
<html>
<head>
    <title>D&D –°–∏–º—É–ª—è—Ç–æ—Ä</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="/manifest.json">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/icon.png">
</head>
<body>
    <div class="container">
        <h1>–ü–æ–±–µ—Ä–µ–∂—å–µ –ú–µ—á–µ–π üè∞</h1>

        <div class="controls">
            <button onclick="addNPC()">–°–æ–∑–¥–∞—Ç—å NPC</button>
        </div>

        <div id="npc-list" class="npc-list"></div>

        <!-- –ë–ª–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ -->
        <div id="status" style="margin-top: 20px; color: #666; font-size: 0.9em;"></div>
    </div>

    <script src="script.js"></script>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ —ç–∫—Ä–∞–Ω
        function updateStatus(text) {
            document.getElementById('status').innerHTML = text;
            console.log(text);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker
        if ('serviceWorker' in navigator) {
            updateStatus('–ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker...');

            navigator.serviceWorker.register('/sw.js')
                .then(registration => {
                    updateStatus('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!');

                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
                    caches.open('dd-sim-v1').then(cache => {
                        cache.keys().then(keys => {
                            const cachedFiles = keys.map(key => key.url.split('/').pop());
                            updateStatus(`üìÅ –ó–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ${cachedFiles.join(', ')}`);
                        });
                    });
                })
                .catch(error => {
                    updateStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
                    console.error('–û—à–∏–±–∫–∞ Service Worker:', error);
                });
        } else {
            updateStatus('‚ùå –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Service Workers');
        }
    </script>
</body>
</html>